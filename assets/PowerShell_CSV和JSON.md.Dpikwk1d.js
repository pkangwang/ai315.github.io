import{_ as s,c as a,o as i,a2 as n}from"./chunks/framework.84TDCN6B.js";const C=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"PowerShell/CSV和JSON.md","filePath":"PowerShell/CSV和JSON.md"}'),p={name:"PowerShell/CSV和JSON.md"},e=n(`<p>PowerShell内置了对CSV文件的读取和写入。</p><h2 id="csv" tabindex="-1">CSV <a class="header-anchor" href="#csv" aria-label="Permalink to &quot;CSV&quot;">​</a></h2><p>例如有一个1.csv文件，内容如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>名称,数量</span></span>
<span class="line"><span>苹果,5</span></span>
<span class="line"><span>橘子,10</span></span>
<span class="line"><span>梨子,8</span></span></code></pre></div><p>如下命令读取CSV内容：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">import-csv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.csv</span></span></code></pre></div><p>这将按对象格式打印出CSV内容，PowerShell会自动识别首行作为字段名：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>名称 数量</span></span>
<span class="line"><span>---- ----</span></span>
<span class="line"><span>苹果 5</span></span>
<span class="line"><span>橘子 10</span></span>
<span class="line"><span>梨子 8</span></span></code></pre></div><p>如下示例打印每一行并且打印每个字段：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$rows = import-csv  1.csv</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$rows.length  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3  有几条记录（排除第一行）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">foreach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> （$row </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $rows）{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $row   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 打印每一行</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>这里的rows是一个数组，CSV中的每一行记录对应数组的一个元素。</p><h2 id="json" tabindex="-1">JSON <a class="header-anchor" href="#json" aria-label="Permalink to &quot;JSON&quot;">​</a></h2><p>PowerShell也内置对JSON文件的读取和写入。</p><p>使用如下命令从CSV转为JSON：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">import-CSV</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.csv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -delimiter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;,&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  convertto-json</span></span></code></pre></div>`,15),t=[e];function l(h,c,o,r,k,d){return i(),a("div",null,t)}const v=s(p,[["render",l]]);export{C as __pageData,v as default};
